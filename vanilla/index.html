<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>List of Pokémon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <style>
        .listing {
            --fade-duration: 500ms;
            font-family: sans-serif;
        }

        .listing ul {
            position: relative;
            padding-left: 1rem;
        }

        .listing li {
            font-size: 1rem;
            margin-bottom: 0.2rem;
        }

        .listing[data-state="loaded"] ul:after,
        .listing[data-state="loading"] ul:after {
            content: " ";
            width: calc(100% + 4px);
            height: calc(100% + 4px);
            display: block;
            position: absolute;
            top: -2px;
            left: -2px;
        }

        .listing[data-state="loading"] ul:after {
            cursor: wait;
            background-color: transparent;
        }

        @keyframes fade {
            0%, 100% {
                opacity: 0
            }
            50% {
                opacity: 1
            }
        }

        .listing[data-state="loaded"] ul:after {
            background-color: #fff;
            animation-name: fade;
            animation-duration: var(--fade-duration);
            animation-direction: forwards;
            animation-timing-function: ease-in-out;
        }
    </style>
</head>
<body>
    <div id="root" class="listing" data-state>
        <h1>List of Pokémon</h1>
        <ul>
            <li>░░░░░░</li>
            <li>░░░░░</li>
            <li>░░░░░░░</li>
            <li>░░░░</li>
            <li>░░░░░░░░░</li>
            <li>░░</li>
            <li>░░░░░░░</li>
            <li>░░░░░</li>
            <li>░░░░</li>
            <li>░░░</li>
        </ul>
        <button disabled>Previous</button>&nbsp;<button>Next</button>
    </div>
    <script>
        function PokémonListing(root) {
            if (!root) throw new Error("Root element not set.");

            const timeToAnimationComplete = parseInt(getComputedStyle(root).getPropertyValue("--fade-duration"));
            const li = root.querySelectorAll("li");
            const [btnPrev, btnNext] = root.querySelectorAll("button");

            const model = {
                data: [],
                limit: 10,
                offset: 0,
                async update() {
                    try {
                        const response = await fetch(`https://pokeapi.co/api/v2/pokemon/?limit=${this.limit}&offset=${this.offset}`);
                        const json = await response.json();
                        this.data = json.results;
                        this.onUpdate();
                    } catch (error) {
                        this.onError();
                    }
                },
                nameByIndex(index) {
                    return this.data[index].name
                },
                next() {
                    this.offset += this.limit;
                    this.update();
                },
                prev() {
                    this.offset -= this.limit;
                    this.update();
                },
                onUpdate: () => {},
                onError: () => {},
            };

            model.onUpdate = function() {
                root.dataset.state = "loaded";

                setTimeout(() => li.forEach((el, index) => el.textContent = model.nameByIndex(index)), timeToAnimationComplete / 2);
                setTimeout(() => root.dataset.state = "", timeToAnimationComplete);

                btnPrev.disabled = model.offset === 0;
                btnNext.disabled = model.offset === 30;
            }

            btnPrev.addEventListener("click", () => {
                if (root.dataset.state !== "") return;
                root.dataset.state = "loading";
                model.prev()
            });

            btnNext.addEventListener("click", () => {
                if (root.dataset.state !== "") return;
                root.dataset.state = "loading";
                model.next()
            });

            model.update();
        }

        PokémonListing(document.getElementById("root"))
    </script>
</html>