<!doctype html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <title>List of Pokémon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body>
    <style>
        .pokemon ul {
            min-height: calc(1rem * 10);
        }
        .pokemon li {
            height: 1rem;
        }
    </style>
    <div class="pokemon">
        <h1>List of Pokémon</h1>
        <ul class="js-list"></ul>
        <button class="js-previous" disabled>Previous</button>&nbsp;<button class="js-next">Next</button>
    </div>
    <script>
        function PokémonListing(rootEl) {
            if (rootEl === null) throw new Error("root element not found");

            const model = {
                offset: 0,
                limit: 10,
                data: [],
                onChange() {},
                async update() {
                    const response = await fetch(`https://pokeapi.co/api/v2/pokemon/?limit=${this.limit}&offset=${this.offset}`)
                    const json = await response.json();
                    this.data = json.results
                    this.onChange();
                },
                next() {
                    this.offset += this.limit;
                    this.update();
                },
                prev() {
                    this.offset -= this.limit;
                    this.update();
                }
            }

            const state = {
                loading: true
            }

            function renderList(rootEl, data) {
                const list = rootEl.querySelector(".js-list");
                if (list === null) throw new Error("list not found");

                let fragment = new DocumentFragment();
                data.forEach(item => {
                    const el = document.createElement("li");
                    el.textContent = item.name;
                    fragment.appendChild(el);
                });

                list.replaceChildren(fragment);
            }

            const nextEl = rootEl.querySelector(".js-next");
            if (nextEl !== null) nextEl.addEventListener("click", event => {
                if (state.loading) return;
                state.loading = true;
                model.next()
            });

            const prevEl = rootEl.querySelector(".js-previous");
            if (prevEl !== null) prevEl.addEventListener("click", event => {
                if (state.loading) return;
                state.loading = true;
                model.prev();
            });

            model.onChange = function() {
                state.loading = false;
                renderList(rootEl, this.data);
                prevEl.disabled = model.offset === 0;
                nextEl.disabled = model.offset === 30;
            }

            model.update();
        }

        PokémonListing(document.querySelector(".pokemon"))
    </script>
</html>